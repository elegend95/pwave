\documentclass[12pt,a4paper,openbib]{article}
\usepackage[latin1]{inputenc}
\usepackage[italian]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{subfig}
\usepackage{parskip}

\usepackage{multicol}
\usepackage{graphicx}
\usepackage{float}
\usepackage[italian]{varioref}
\author{ Niccolo' Baldelli}
\title{Logbook}
\begin{document}
	\maketitle
\section{6 febbraio}

Leggere Report Mazza Carusotto ecc.

stiamo cercando di semplificare la dinamica di un sistema di anyoni con \textbf{simmetria rotazionale} all'interno di un gas di N particelle.

Hamiltoniana per il sistema non rotante: $H_1(dz,dzbar,z,zbar,t)$, mi pongo in un sistema rotante, in questo modo le coordinate trasformano come: $z_2=z_1e^{-i\theta(t)}$, trasformazione implementabile dall'operatore $V=e^{-i/\hbar\theta(t)L_z}$

La wf cambio conseguentemente come $\psi_2(z')=\psi_1(z)=V^\dagger\psi_1(z')$ sta cosa non mi piace per nulla.

forse può risolvere situazione capitolo 10 del paffu in cui si usa trasformazione attiva, discutere

Per trovare il generatore traslazioni temporali nel sdr 2 devo imporre:
\begin{equation*}
i\hbar\frac{d}{dt}|\psi_2>=H_2|\psi_2>\rightarrow H_2=H_1+i\hbar\frac{dV^{\dagger}}{dt}V
\end{equation*}

derivando e usando l'eq di shroedinger per $|\psi_1>$.

La parte successiva viene dimostrato che il potenziale nel sistema 2 è indipendente dal tempo: non mi torna come mai la fase della coordinata $\eta$ degli anyoni sparisce.

A questo punto viene fatta l'evoluione temporale dello stato nel sistema 2, assumendo che sia adiabatica e, usando una versione a tempi fini ti della fermi golden rule, che lo stato rimanga nel ground state manifold.

Lo stato finale, partendo da uno iniziale $\bar{\alpha}$, si scrive come una sovrapposizione di tutti i ground states, più un termine di fase comune inutile:

\begin{equation*}
i\hbar\frac{d}{dt}\psi_2=e^{-i/\hbar E_0 t}\sum_{\alpha}\gamma_{\alpha}(t)|\alpha(0)>
\end{equation*} 

con $\gamma_{\alpha}$=0 for t=0.

Solvin the shr equation for gamma we get two different contribution in the abelian or not abelian cases.

\begin{equation*}
|\psi(T)>=dynphase*\sum_{\beta}\left[e^{i\theta_f\ell}\right]_{\beta,\alpha}|\alpha(0)>
\end{equation*}

I think there is an error on the report here over the summation

\textbf{NB}: there are important caveats, i.e. putting a specific angle to lose one messy term (what?) geometric contributions in NA systems are only multiples of identity

Switching back to the lab frame we get:

\begin{equation*}
\psi(T)_lab=dynphase*e^{-i/\hbar\theta_fL_z}*berry*initial state
\end{equation*}

That last operator inserted is a problem, because in the A case, if $\theta_f$ just exchanges the anyons it only creates a phase wich is not observable (same in NA?)

Questions: better grasp of rotations, what happened in this last passage.

Maybe the rotation contribution of the final phase of the wf vanishes because the system is rotationally invariant i.e. wf are eigenstates of L

\textbf{lettura main v2, provisory paper}

I only know that there are systems FQH described by moore read states that can host nonabelyan excitations (quasiholes)

To get rid of the non-topological term in the berry phase we subtract the misurations with 2 anyons and the one with 1 (why we put one on another?)

we can switch angular momentum mean with a mean of $r^2$ via a transformation that i don't understand.

\section{8 Febbraio}

Reading of Tong and Khare about Fractional statistics.

FQHE: electrons are disposed on Landau Levels BUT interact with each other, supposedly hard core, and with a uniformely positive background (why no bands?) 

We are interested in excitation above the ground state. For \textbf{odd} filling of landau levels GS are Laughlin WF:
\begin{equation*}
\psi(z_i)=\prod_{i<j}(z_i-z_j)e^{-\sum_i|z_i|^2/l_b^2}
\end{equation*}

Notes on Laughlin: the terms befor the exponential assure antisymm (for m odd) and hard core repulsion

Simplest excitation on this GS are quasi-holes, created multiplying Laughlin by $\prod_i(z_i-\eta)$, these excitation have charge $e/m$ because if you multiply m of em you get a electronic WF.

An infinitly thin flux tube in a given position does the job because it shifts the levels (spectral flow) and effectively adds a $\prod z_i$ term in the WF.

We can compute the charge of the excitation by moving the flux around a closed path and enforcing that the phase aquired is of aharonov-bohm type

If instead we encircle another flux tube we get another contribution: Topological! 

\textbf{ask for clarification between tong and khare calculations}

\section{11 febbraio}

Consideration on statistic vs charge computation in laughlin:

Tong uses the same method of Nayak (better), two adiabatic parameters: $\eta,\bar{\eta}$ (talk about this) and wf normalized. We can neglect the derivation over the mixed terms particles-anyons employing plasma analogy and screening.

Done that we get two terms in berry connection:

\begin{equation*}
A_{\eta}=-\frac{i}{2m}\sum\frac{1}{\eta_i-\eta_j}+\frac{i\bar{\eta_i}}{4ml_b^2}
\end{equation*}

First term vanishes if we not enclose another Anyon (see complex integrals), the second is the \textbf{geometric contribution} that in this case is just a Aharonov-Bohm phase (there is a magnetic field) and helps compute fractional charge.

If we enclose another anyon we get a \textbf{topological phase} too, independent on the path, that is $\alpha=1/m$ with m the filling. 

Khare calculation is a bit superficiale. We can almost safely assume that normalization is required via a calculation of generic Berry phase in Nayak review (abelian case).

\section{12 febbraio}
\textbf{Reading of reference 0611022}

Phenenology of p-wave in 3D: usual square root spectrum:
\begin{itemize}
	\item ungapped for some k at $\mu>0$: \textbf{weak pairing regime}, excitations are collective fermi surface phenomena (bogoliubov?)
	\item gapped everywhere for $\mu<0$, intuitive picture: single excitation is the breaking of a cooper pair (right?)
\end{itemize}

In 2D spectrum is gapped everywhere but there is still a distinction in the \textbf{correlation function form}:
\begin{itemize}
	\item $\mu<0$ strong pairing, non topological, exponential decay
	\item $\mu>0$ weak pairing, \textbf{topological}, power law fall
\end{itemize} 

We use the classic bogoliubov hamiltonian with a \textbf{uniform order parameter} $\Rightarrow$ we can diagonalize in \textbf{k} space:
\begin{equation*}
\gamma_k=u^*_ka_k+v^*_kka^\dagger_{-k}
\end{equation*}

that gives rise to the classic BCS ground state:

\begin{equation*}
|BCS>=\prod_k\left(u^*_k+v^*_ka^\dagger_{-k}a^\dagger_{k}\right)|0>
\end{equation*}

In real space that can be written as a product of pair correlation functions for every particle (correctly antisymmetrized), with:
\begin{equation*}
g(r)=\int\frac{d^2k}{2\pi}e^{i\mathbf{k}\cdot \mathbf{r}}\frac{v_k}{u_k}
\end{equation*}

using the explicit form for these terms diagonalizing BdG equation we can extract asymptotic behaviour for $\mu<0$ and $\mu>0$. For $\mu>0$ we get a power kaw $g$ and the WF resembles \textbf{Moore Read}!

So there is a topological transition between two gapped phase with \textbf{no local order parameter} and behaviour controlled by $\mu$. The mathematical details are difficult!

\textbf{explicit bdg}:

we can write the hamiltonain in the form:

\begin{equation*}
H=\begin{pmatrix}
h&\Delta\\ \Delta^\dagger & -h
\end{pmatrix}
\end{equation*}

with $\Delta$ antisymmetric (\textbf{demonstrate this}).

Hamiltonian properties:
\begin{itemize}
	\item even number of eigenvalues
	\item particle-hole simmetry $\rightarrow$ eigenvalues are mirrored
\end{itemize}

eventual zero modes can appear/disappear only in pairs if ph simmetry is preserved in hamiltonian evolution, so we can create a \textbf{topological invariant} $(-1)^{N_z}$.

But being even the number of eigenvalues there are always even number of zero modes that in general are destroyed by perturbations

\textbf{NB}: vortices are NOT dynamical objects but defects in the landscape, so they are written in the hamiltonian, in particular in the order parameter $\Delta$

To clear things up read:
-quantum liquids legget 5.4 and 5.C to get the real formulation of bcs ground state
-grosso superconductivity for the same reasons (dopo)
-ivanov reference 78 in 0622...
-how the topological invariant is builded

levenstein goldman cooper pollman schmidt trebst diehl fazio

\section{13 febbraio}

\textbf{consideration on topological invariant}

When we diagonalize BdG hamiltonian we obtain two complex quantities $u_k$, $v_k$ up to an overall phase, and with $|u|^2+|v|^2=1$ so we are left with two DoF, these can be mapped to unit vectors via:
\begin{equation*}
n_\mu=\sigma^\mu_{ab}\psi^*_a\psi_b
\end{equation*}

In this way we are left with a theory $S^2\rightarrow S^2$ with homotopy group $\pi_2(S^2)$ and topological invariant (winding number):
\begin{equation*}
N_3=\frac{1}{4\pi}\int d^2k[\mathbf{n}\cdot\partial_a\mathbf{n}\times\partial_b\mathbf{n}]
\end{equation*}

inserting explicit form of $n$ we get that in $\mu>0$ $N_3=1$ otherwise zero.

\textbf{reading of legget quantum theory of liquids}

trying to understand the real structure of BCS ground state

We can write finite nummber BCS GS in this form:
\begin{equation*}
\psi=A\phi(r_1,r_2)\phi(r_3,r_4)\dots\phi(r_{N-1}r_N)
\end{equation*}

with A antisimmetrization operator. In second quantization this becomes:
\begin{equation*}
\psi=Norm\left(\int dr dr' \phi(r,r')\psi^\dagger(r)\psi^\dagger(r')\right)^{N/2}|0\rangle=Norm\Omega^N|0\rangle
\end{equation*}

We can employ traslational invarance (CAN WE IN P-WAVE?) to fourier transform:
\begin{equation*}
\psi=Norm\left(\sum_k c_k a_k^\dagger a_{-k}^\dagger\right)^{N/2}|0\rangle
\end{equation*}

If we admit arbitrary number of particles we have $\psi=e^{\Omega}|0\rangle$ that expanding gives all terms of $\Omega^N$.

Now expanding the exponent and remembering that $(a^\dagger a^\dagger)^2=0$ we are left with:
\begin{equation*}
\psi=Norm\prod_k\left(1+c_k a^\dagger_k a^\dagger_{-k}\right)|0\rangle
\end{equation*}

and equating with the usual rapresentation of GS we are left with $c_k=v_k/u_k$

\section{14 febbraio}

\textbf{reading of Ivanov (2001)}

we know that a GS with 2n anyons has a $2^n$ degeneracy (occupied or unoccupied fermions), we can construct adiabatic braiding operators on this GS that respect the intuitive relations (operator $T_i$ switch i anyon with i+1 anyon):

\begin{equation*}
T_iT_j=T_jT_i \qquad T_iT_jT_i=T_jT_iT_j \quad\text{Yang-Baxter}
\end{equation*}

we are actually discarding in the creation of these operators any kind of dynamical-geometrical phase

We also know that switching 2 anyons transform $\gamma\rightarrow-\gamma$ because if we apply a $U(1)$ transformation on the order parameter this transformation can be splitted on the two creation and annihiliation operators inside the gap function and consently on $u,v$ functions:
\begin{equation*}
(u,v)\rightarrow(ue^{i\phi/2},ve^{-i\phi/2}) \Rightarrow \phi=2\pi 
\end{equation*}

so the braiding operator action is:
\begin{equation*}
T_i=\begin{cases}
\gamma_i\rightarrow\gamma_{i+1}\\
\gamma_{i+1}\rightarrow\gamma_i\\
\gamma_j\rightarrow\gamma_j
\end{cases}
\end{equation*}

we can build a representation of this group on operators asking that $U\gamma U^{-1}=T_i(\gamma)$
and so we get:
\begin{equation*}
U_i=\exp\left(\frac{\pi}{4}\gamma_{i+1}\gamma_i\right)
\end{equation*}
for 2 anyons we get a 2 dimensional representation, for 4 a 4 dimensional, for 6 a 8 dim ecc ecc.
\textbf{N.B} representation of braid group can  only mix states with \textbf{same fermion parity!} for reasons that we'll see now.

\textbf{reading of last part of 06221}

we have already written BdG equation but \textbf{why does $\Delta$ have to be skew.symmetric?} Discuss.

we already said that zero modes can appear or disappear only in pairs, BdG has an even number of eigenvectors $\rightarrow$ even number of zero modes (not proected \textbf{shouldn't the gap protect these states?})

But we can put one zero mode in the center in a vortex and the other on the boundary: we put a vortex with order parameter
\begin{equation*}
\Delta(r)=\frac{i}{2}e^{il\phi}f^2(r)
\end{equation*}
with f(r) vanishing in the center of the vortex.

Doing that we end up with a strange form for BdG \textbf{why is the phase splitted on the sides of the derivative???}

It is splitted bc we need a symmetric hamiltonian under fermion switch, for uniform order parameter that is trivial.

\section{20 febbraio}

\textbf{reading of 1712.09904} protracted for days

They start by writing down the BdG hamiltonian in bogoliubov for a particolar value of $\mu=m\Delta^2/2$ that allows a complete analytical treatment.

The GS for this class of hamiltonians are:
\begin{equation*}
|G\rangle=\alpha_{k=0}\prod_{k>0}\alpha_k\alpha_{k=0}-k|0\rangle \Rightarrow |G\rangle=\psi^\dagger_{k=0}\exp\left(\frac{m\Delta}{2i}\sum\frac{\psi^\dagger_k\psi^{dagger}_{-k}}{k_x+ik_y}\right)
\end{equation*}

\textbf{NB} we have for $\alpha$ (bogoliubov), only positive $k$, for $\psi$ we have veryone
The bogoliubov GS can be tought as is becous if we apply again a bogoliubov it becomes zero for fermion construction

We study this hamiltonian for a \textbf{Uniform order parameter} and \textbf{infinite boundaries}.

We get a unique ground state by writing the hamiltonian as a bulk term with a positive definite form (\textbf{look photo, write down better}) + a boundary term that dies at infinity.

\section{25 febbraio}

\textbf{Calculations on OneNote}

In this days I'm writing down the expextation value of the angular momentum operator on the ground state of 1712.09904 both in the vortexless case and in the vortex one. Remark: wavefunction is \textbf{unrenormalizable} as written in page 2.

Trying to fourier transform the angle (angolar momentum decomposition) makes L expectation value diagonal but makes calculation of ground state difficult \textbf{N.B}: the problem with vortices does not even have rotational simmetry either.

We try to fourier transform in the usual way.

\textbf{calculations}

Usiamo le forme di $u_k$ e $v_k$ per $\mu=m\Delta^2/2$ con $m\Delta=1$ (Wang Hazzard):
\begin{equation*}
u_k=\frac{i(k_x+ik_y)}{\sqrt{k_x^2+k_y^2+1}} \quad v_k=\frac{1}{\sqrt{k_x^2+k_y^2+1}}
\end{equation*}

che danno $g(z,z')=1/(z-z')$. Gli op. di Bogoliubov che diagonalizzano l'hamiltoniana sono:
\begin{equation*}
\alpha_k=u_k\psi_k-v_k\psi^\dagger_{-k} \quad \alpha^\dagger_k=u_k^*\psi^\dagger_k-v^*_k\psi_{-k}
\end{equation*}

Esprimiamo i fermioni in termini di bogoliubov qp:
\begin{equation*}
\psi_k=u^*_{k}\alpha_k-v_k\alpha^\dagger_{-k} \qquad \psi^\dagger_k=u_{k}\alpha^\dagger_k-v^*_k\alpha_{-k}
\end{equation*}

Nel valore di aspettazione:
\begin{equation*}
\langle L_z\rangle=-i\hbar_\alpha\langle0|\int d^2x\psi^\dagger(\vec{x})(x\partial_y-y\partial_x)\psi(\vec{x})|0\rangle_\alpha
\end{equation*}
in trasformata di fourier:
\begin{equation*}
-i\hbar_\alpha\langle0|\int d^2x\int\frac{d^2k}{(2\pi)^2}e^{-i\vec{k}\cdot\vec{x}}(u_{k}\alpha^\dagger_k-v^*_k\alpha_{-k})(x\partial_y-y\partial_x)\int\frac{d^2q}{(2\pi)^2}e^{i\vec{q}\cdot\vec{x}}(u^*_{q}\alpha_q-v_q\alpha^\dagger_{-q})|0\rangle_\alpha
\end{equation*}
Sopravvive soltanto il termine vv e una $\delta$ dal termine $\alpha_{-k}\alpha^\dagger_{-q}$ (\textbf{a questo punto ci vorrebbe normalizzazione del gs}):
\begin{equation*}
\hbar\int\frac{d^2kd^2q}{(2\pi)^4}d^2xv^*_k(xq_y-yq_x)v_qe^{i(\vec{q}-\vec{k})\cdot\vec{x}}\delta^2(\vec{q}-\vec{k})
\end{equation*}

Integrando la delta:
\begin{equation*}
\hbar\int\frac{d^2k}{(2\pi^4)}d^2x\frac{(xk_y-yk_x)}{k_x^2+k_y^2+1}
\end{equation*}

che fa zero (???)
\textbf{***conti vecchi sbagliati***}

La presenza di x e y da luogo a delle $\delta'$
\begin{equation*}
\hbar\int\frac{d^2kd^2q}{(2\pi)^4}v^*_kv_q q_y\int dxx e^{i(q_x-k_x)x}\int dy e^{i(q_y-k_y)y}=-i\hbar\int\frac{d^2kd^2q}{(2\pi)^2}v^*_kv_q q_y\delta'(q_x-k_x)\delta(q_y-k_y)
\end{equation*}
\begin{equation*}
-\hbar\int\frac{d^2kd^2q}{(2\pi)^4}v^*_kv_q q_x\int dx e^{i(q_x-k_x)x}\int dy y e^{i(q_y-k_y)y}=i\hbar\int\frac{d^2kd^2q}{(2\pi)^2}v^*_kv_q q_x\delta(q_x-k_x)\delta'(q_y-k_y)
\end{equation*}
Esplicitando la forma di v e integrando la delta e la delta derivata (ho usato mathematica):
\begin{equation*}
-i\hbar\int\frac{d^2kdq_x}{(2\pi)^2}\frac{k_y\delta'(q_x-k_x)}{\sqrt{k_x^2+k_y^2+1}\sqrt{q_x^2+k_y^2+1}}= -i\hbar\int\frac{d^2k}{(2\pi)^2}\frac{k_xk_y}{(k_x^2+k_y^2+1)^2}
\end{equation*}

analogamente per l'altro termine viene la stessa cosa con segno opposto quindi il risultato è zero (???) consistente con il fatto che il valore atteso verrebbe immaginario?

\section*{10-11 marzo}

I have managed to diagonalize 1d hopping matrix with sparce matrices.

Problem: halved brillouin zone, must correct lower band OR use other method to find momentum (\textbf{approfondisci questa parte})

TODO: 
-write functions for 2D hopping \textbf{check}

-diagonalize 2D hopping \textbf{check}

-switch brillouin zone (not useful for 2d i guess) MAYBE YES BC PROBLEM WITH PARABOLA

-insert non number conserving term \textbf{check}

-try to include all sparse matrices info in class

PROBLEMS:
-try to write down a better way to discriminate between left and right (upper and lower) neighbor in hamiltonian and momentum operator (latter case even x and y difference)

-Why does parabole switch sign if i change mu sign, try implementing different way of calculating k

switching back to 1d to solve starting point of parabola problem, i notice that the eigenvalues not calculated are in the bottom band (the ones i need!!). must look how it works ARPACK

\textbf{Problems solved!} noting that I can use the WHICH option in ARPACK to sort eigenvalues and \textbf{mu gets a factor of 2 in discretization for every dimension}. I'm cheating a bit bc I discard the upper band.

\textbf{-Study what happens changing the chemical potential and what is the topological regime }

\subsection*{Lattice hamiltonian diagonalization}

Real space hamiltonian is:
\begin{equation*}
H=\int d^2x\psi^\dagger(-\frac{\nabla^2}{2m}-\mu)\psi+\frac{1}{2}\left(\Delta\psi(\partial_x+i\partial_y)\psi-\Delta\psi^\dagger(\partial_x-i\partial_y)\psi^\dagger\right)
\end{equation*}

The kinetic term is discretized by:
\begin{equation*}
\begin{split}
K=\sum_{ij} -a^2 c^\dagger_{ij}(\frac{c_{i+1,j}+c_{i-1,j}+c_{i,j+1}+c_{i,j-1}-4c_{ij}}{2ma^2})-\mu c^\dagger_{ij}c_{ij}=\\ \sum_{ij}-\frac{1}{2m}(+c^\dagger_{ij}c_{i+1,j}+c^\dagger_{ij}c_{i-1,j}+c^\dagger_{ij}c_{i,j+1}+c^\dagger_{ij}c_{i,j-1})+(2/m-a^2\mu)c^\dagger_{ij}c_{ij}
\end{split}
\end{equation*}

I have parameters $t=-1/2m, \, \mu=4t-a^2\mu_0$
Going in momentum space we can diagonalize using (for both axis i and j):
\begin{equation*}
c^\dagger_j=\int_{-\pi/a}^{\pi/a}d^2ke^{-iqaj}c^\dagger_k
\end{equation*}
that gives:
\begin{equation*}
	E(\vec{k})=-\frac{1}{ma^2}(\cos(k_xa)+\cos(k_ya)-2)-\mu_0
\end{equation*}
that is our fine dispersion for $ka\rightarrow0$ (\textbf{what kind of limit do I have to take})


\subsection*{Lattice momentum diagonalization}
Real space momentum is (i.e. along x):
\begin{equation*}
P_x=-i\int d^2x\psi^\dagger\partial_x\psi
\end{equation*}

that becomes:
\begin{equation*}
P_x=-ia\sum_{ij}c^\dagger_{ij}(c_{i+1,j}-c_{i-1,j})
\end{equation*}
with the same convention as before:
\begin{equation*}
P_x=\frac{\sin(k_xa)}{a}\int d^2k c^\dagger_kc_k
\end{equation*}

\section{12-13 marzo}

my code works but i have to find a clever way to plot the eigenvalues.
-Try to diagonalize a qualsiasi matrix in second quantization using H=U+DU where D is diagonal and find why can u use translations to write down the momentum value.
-Try to make the problem scalable (at least 1D)
-Try to use tweaks to calculate the whole spectrum

Scaling problem:

my problem has 3 lenght scales: $m,L,a$, I can construct my simulation using just $L/a=\tilde{L}$ and $ma=\tilde{m}$, forse dovrei passare pure i c in variabili adim??

Putting $c=\hbar=1$ we have that $[H]=[m]=-1$, $[x]=1$ so dimension of fields are:
\begin{equation*}
H=\int d^2x \frac{1}{m}c^\dagger(\nabla^2)c \Rightarrow -1=2+1+d-2+d \Rightarrow d=-1
\end{equation*}

we can then construct a scale invariant Ham putting $\tilde{c}=ac$

RISOLTI PROBLEMI DI GRAFIC MERDOSI: we have to set \textbf{different phases} for x and y matrix element in hamiltonian

NUOVO PROBLEMA: se ci metto il pairing particle hole la zona a energia negativa mi si schifa, il prblema sta negli autovettori come prma, ricordiamoci che cambiare da sparse a dense matrices è inutile da questo punto di vista

\section*{18-20-21 marzo}

The good way to make a scale invariant hamiltonian is the one that I have developed! (APPROFONDISCI E SCRIVI PASSAGGI) 

\textbf{IMPORTANTE}: the good way to scale the hamiltonian is to \textbf{make explicit the dependence of fermionic operator on lattice spacing}. In this way we can transfer this dependence on the matrix itself and diagonalize.

For example in our system, with hbar=1, the fields $C:i$ have dimension \textbf{-1}, so we have to divide the hamiltonian to diagonalize by $a^2$ to get the usual spectrum .

On another point if we do such we must not put the 1/2 in front of the hamiltonian that we want diagonalize \textbf{for reasons}.

\textbf{N.B}: il lattice spacing deve sempre essere minore di 1 sennò non torna un cazzo (non reggono più le approssimazioni)


-guardare se con matrici full spariscono outliers

	I tried to plot heat maps to see where are the different outliers varying lattice spacing and using full vs sparse
	with full matrix i.e. with 10 edge points I have a problem in just ONE point, in particular ALWAYS in place 190 of eigenvalues array
	for 12 edge points we have same problem at point 226 ALWAYS and with ALWAYS energy 20 like before
	with 14 same: inconsistent placing in the array but always the same energy value!
	
	The problem is that on the botton of the band, where kx and ky should be zero, also eigenvectors entries are compatible with zero, so cacl
	
-guardare come scala tempo calcolo con numero siti (sia full che sparse)

-implementre cython

\section*{22-23 marzo}

Sparse diagonalization is A LOT less efficient than full, at least for matrices with thousands of element. 

TODO: 
-learn git

quite done

-implement cython

ask tommaso comparin compatibility issues and if it's better to work with or wo scipy and when  is better to use sparse

Implementaion of vortices:
\begin{itemize}
	\item set OBC instead of PBC
	\item how to define $\Delta$ on site instead of link?
\end{itemize}

\section{25 marzo}
Come immaginavo non è più possibile definire l'impulso come il generatore delle traslazioni con OBC, e pure calcolandolo usando direttamente l'operatore non si arriva a nulla. Limitiamoci a calcolare le GS properties usando le WF sfruttando \textbf{reference pwave easy pag 5}

For a general BCS Vacuum we have that operators can be written as:
\begin{equation*}
\sum \langle0|c^\dagger_iO_{ij}a_j|0\rangle=\sum\langle0|(v_{im}b+u^*_{im}b^\dagger)O_{ij}(v^*_{jn}b^\dagger+u_{jn}b)|0\rangle=\sum v_{im}O_{ij}v^*_{jm}|0\rangle
\end{equation*}

where the vacuum is the bogoliubov one and the m,n index indicises the basis decomposition (without vortices is fourier momentum base)

We have used read green convention, so in fourier space we have $b_k=u_kc_k-v^\star_kc^\dagger_{-k}$
	
writing down a \texttt{number} function we get that summing all the u or all the v gives the number of lattice points for every choice of delta and mu, this is kinda easy.

\section{26 marzo}

How to calculate density? We know that, at least in the case where k is a good quantum number (PBC):
\begin{equation*}
\langle BCS|c^\dagger_jc_j|BCS\rangle=\int d^2kd^2qe^{i(q-k)j} \langle BCS| c^\dagger_q c_k|BCS\rangle
\end{equation*}
using our definition of fermions in term of bogoliubov (vedi 25 febbraio):
\begin{equation*}
n(j)=\int d^2k d^2q e^{i(q-k)j}v^*_qv_k
\end{equation*}

with v that is the lower part of our discrete vectors. PROBLEM: do I have to take ALL eigenvectors or just the ones with positive energy?

If I sum over the j I get the usual number operator
\
if I discretize using the usual scaling properties I get:

\begin{equation*}
n(j)=a^2\sum_{k,q}e^{i(q-k)j}v_q^*v_k
\end{equation*}

In this way we get uniform density for PBC (makes sense)

\section*{27 Marzo}

Facciamo mente locale sui nostri vettori che NON sono in base dell'impulso.
I have a LxL lattice, that means a matrix with 2 times L**2 eigenvalues

When i diagonalize I obtain:
\begin{itemize}
	\item $2L^2$ eigenvalues and eigenvectors ,half with positive, half with negative energy.
	\item If I want to compute density I have just to keep the positives
	\item each eigenvector is $2L^2$ elements long
	\item if we want the $v$ we have to keep just the last $L^2$ elements
\end{itemize}
The number of particles is:
\begin{equation*}
N=\sum_i\langle BCS|c^\dagger_ic_i|BCS\rangle=\sum_i\langle BCS|(v_{im}b_m+u^*_{im}b^\dagger_m)(u_{im}b_m+v^*_{im}b^\dagger_m)|BCS\rangle
\end{equation*}
with m eigenvector index and i position in the eigenvector index.

So 
\begin{equation*}
N=\sum_iv_{im}v^*_{im}
\end{equation*}
Sum on m is intended. We are summing only on positive enrgy m.

\textbf{NB}: when we are plotting things at $\Delta=0$ we get \textbf{wrong eigenvectors} so maybe also density plot is wrong

\section*{28 Marzo}

TODO: write an efficent way to insert vortex phase in order parameter

\subsection{Position dependent order parameter}

We have to set an order parameter $\Delta(\vec{r})=\Delta e^{i\phi(r)}$ where $(r,\phi)$ are the coordinates of a certain point with respect of the vortex core and we have to set $\Delta=0$ on the core. To have an Hermitian coupling:
\begin{equation*}
\frac{1}{2}\int d^2x(\sqrt{\Delta(r)}\psi(r))(\partial_x+i\partial_y)(\sqrt{\Delta(r)}\psi(r))-(\sqrt{\Delta(r)}^*\psi^\dagger(r))(\partial_x-i\partial_y)(\sqrt{\Delta(r)}^*\psi^\dagger(r))
\end{equation*}

that discretized is:
\begin{equation*}
\sum_{ij}\frac{\Delta}{4a}\left(\sqrt{e^{i\phi_i}e^{i\phi_{i+1}}}c_ic_{i+1}-\sqrt{e^{i\phi_i}e^{i\phi_{i-1}}}c_ic_{i-1}\right)+H.c.
\end{equation*}
plus analogous terms with the y derivative.

So the coupling between sites i and j is the same as usual multiplied by the geometric mean of the phases defined on each point.

We can define for a lattice point $(x,y)$:
\begin{equation*}
e^{i\phi(x,y)}=\frac{(x-x_0)+i(y-y0)}{\sqrt{(x-x_0)^2+(y-y_0)^2}}
\end{equation*}
with $x_0,y_0$ coordinates of vortex. We can multiply two nearby phases and take the square root to define a $\Delta(r)$ on the link, then multiply for the usual terms 1,-1,i,-i deriving from the p+ip term. The phase on the vortex location is set to zero to account for the fact that there $\Delta=0$

\section*{1 aprile}

Density ends up grafically correct if we plot the v components squared of the positive energy eigenvectors but it doesn't sum to the total number of particles. \textbf{NB} If we put inside a vortex in the middle of the systems the density profile is strange (see graphicsq). THERE IS A PROBLEM IF I SET BOTH THE COORD OF VORTEX EQUAL.

Breve recap on how I have indexed asc and ord:

\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\linewidth]{latticecoord}
	\label{fig:latticecoord}
\end{figure}

TODO:

\begin{itemize}

\item write down explicitly number of particles in function of chemical ptential in 2D DONE

	we have to coherently scale quantities in plots.
	
	There is areally strange dependence of the plot SHAPE with a
	
\item change form of confining potential using power of 3000 (IT'S NOT BETTER)

\item check consistency of scaling 'a' and plot density for different as (must be the same).

	Scales right if we divide plotted density by a**2, nearly, there is still a little distinction.

\item fix continuum parameters and check that with pbc the energy gap is good and with obc a massles boundary is formed with spacing (1/2piR).

\item check if adding vortex a zero mode is created

\end{itemize}
There are huge problems varying the parameters, in particular when a=0.14 more or less we have a density that becomes from panettone to vaso. (see graphics) Problem arising only for certain extreme values of the parameters, we can check later.

\section*{4 aprile}

Our code is correct with the a**-2 scaling of density, now to see if the theoretical previsions on the gap are correct.
\begin{itemize}
	\item for PBC: we should e a fully gapped spectrum with gap $\sim2\Delta$
	\item for OBC with circular boundaries with radius R: we should have linear dispersion inside the gap (edge modes), quantized with discretization (1/R)
	\item for OBC with vortex: we must find a \textbf{double degenerate zero mode	}
\end{itemize}

To appreciate boundary modes with OBC we need a big enough system to simulate. If we set L=3 with a 1.35 radius trap we cannot see anything. We are seeing something with L=8 and r=3.88.

\textbf{NB}: I realized that the strange "vase like" behaviour of density (instead of panettone), happens when we generate too few points, that increases increasing mu and delta.

\section*{5 aprile}

TODO evaluate the dependence on lattice points of the spacing between levels. Plot edge modes wavefunctions density



\end{document}

